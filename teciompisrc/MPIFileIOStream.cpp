#include "MPIFileIOStream.h"
#include "ThirdPartyHeadersBegin.h"
#include <iostream>
#include "ThirdPartyHeadersEnd.h"
#include "FileIOStatistics.h"
using namespace tecplot::teciompi; struct MPIFileIOStream::Impl { std::string             ___2462; MPI_Comm                m_comm; MPI_Info                m_info; MPI_File                m_fileHandle; ___372               m_isAscii; DataFileType_e          m_dataFileType; ___3934::FileIOStatistics m_statistics; Impl(std::string const& ___1392, MPI_Comm comm, MPI_Info info) : ___2462(___1392) , m_comm(comm) , m_info(info) , m_fileHandle(NULL) , m_isAscii(___1303) , m_dataFileType(___843) {} }; tecplot::teciompi::MPIFileIOStream::MPIFileIOStream(std::string const& ___1392, MPI_Comm comm, MPI_Info info) : m_impl(new Impl(___1392, comm, info)) {} tecplot::teciompi::MPIFileIOStream::~MPIFileIOStream() {} ___372 MPIFileIOStream::___2040() const { return m_impl->m_fileHandle != NULL; } ___372 tecplot::teciompi::MPIFileIOStream::close(bool ___3362) { ___372 ___3359 = ___4227; if (___2040()) { (void)MPI_File_sync(m_impl->m_fileHandle); ___3359 = (MPI_File_close(&m_impl->m_fileHandle) == MPI_SUCCESS); m_impl->m_fileHandle = NULL; if (!___3362) { int ___2677; (void)MPI_Comm_rank(m_impl->m_comm, &___2677); if (___2677 == 0) (void)MPI_File_delete(const_cast<char*>(___1392().c_str()), MPI_INFO_NULL); } } ENSURE(!___2040()); ENSURE(VALID_BOOLEAN(___3359)); return ___3359; } tecplot::___3934::___1391 tecplot::teciompi::MPIFileIOStream::fileLoc() { REQUIRE(___2040()); MPI_Offset mpiOffset = 0; (void)MPI_File_get_position(m_impl->m_fileHandle, &mpiOffset); return static_cast<___3934::___1391>(mpiOffset); } ___372 tecplot::teciompi::MPIFileIOStream::___3461() { REQUIRE(___2040()); MPI_Offset mpiOffset = 0; ___372 ___3359 = (MPI_File_seek(m_impl->m_fileHandle, mpiOffset, MPI_SEEK_SET)== MPI_SUCCESS); ENSURE(VALID_BOOLEAN(___3359)); return ___3359; } ___372 tecplot::teciompi::MPIFileIOStream::___3460(___3934::___1391 fileLoc) { REQUIRE(___2040()); MPI_Offset mpiOffset = static_cast<MPI_Offset>(fileLoc); ___372 ___3359 = (MPI_File_seek(m_impl->m_fileHandle, mpiOffset, MPI_SEEK_SET) == MPI_SUCCESS); ENSURE(VALID_BOOLEAN(___3359)); return ___3359; } ___372 tecplot::teciompi::MPIFileIOStream::seekToFileEnd() { REQUIRE(___2040()); MPI_Offset mpiOffset = 0; ___372 ___3359 = (MPI_File_get_size(m_impl->m_fileHandle, &mpiOffset) == MPI_SUCCESS) && (MPI_File_seek(m_impl->m_fileHandle, mpiOffset, MPI_SEEK_SET) == MPI_SUCCESS); ENSURE(VALID_BOOLEAN(___3359)); return ___3359; } std::string const& tecplot::teciompi::MPIFileIOStream::___1392() const { return m_impl->___2462; } void tecplot::teciompi::MPIFileIOStream::___3495(___372 ___2001) { REQUIRE(VALID_BOOLEAN(___2001)); m_impl->m_isAscii = ___2001; } ___372 tecplot::teciompi::MPIFileIOStream::___2001() const { return m_impl->m_isAscii; } void tecplot::teciompi::MPIFileIOStream::setDataFileType(DataFileType_e ___842) { REQUIRE(VALID_ENUM(___842, DataFileType_e)); m_impl->m_dataFileType = ___842; } DataFileType_e tecplot::teciompi::MPIFileIOStream::___842() const
{ return m_impl->m_dataFileType; } tecplot::___3934::FileIOStatistics& tecplot::teciompi::MPIFileIOStream::statistics() { return m_impl->m_statistics; } MPI_File tecplot::teciompi::MPIFileIOStream::fileHandle() const { return m_impl->m_fileHandle; } MPI_Comm tecplot::teciompi::MPIFileIOStream::comm() const { return m_impl->m_comm; } ___372 MPIFileIOStream::open(int ___2505) { REQUIRE(!___2040()); int mpiResult = MPI_File_open(m_impl->m_comm, const_cast<char*>(___1392().c_str()), ___2505, m_impl->m_info, &m_impl->m_fileHandle); ___372 ___3359 = (mpiResult == MPI_SUCCESS); if (!___3359) { m_impl->m_fileHandle = NULL; char msg[MPI_MAX_ERROR_STRING]; int resultlen; MPI_Error_string(mpiResult, msg, &resultlen); std::cout << "Error opening file: " << msg << std::endl; } ENSURE(VALID_BOOLEAN(___3359)); return ___3359; }
